<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Use GAN to Generate Anime Style Pictures(to Be Continued) - Yuzi Liang | University of Science and Technology of China</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Yuzi Liang | University of Science and Technology of China"><meta name="msapplication-TileImage" content="/img/favicon2.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Yuzi Liang | University of Science and Technology of China"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="March.14.2020-   1.Web Crawler for Pixiv findPID.py findFollow.py main.py   2.Web Crawler for Konachan 3.Anime Face Recognition and Capture 4.Train   1.Web Crawler for Pixiv https:&amp;#x2F;&amp;#x2F;www.pixiv.net is a"><meta property="og:type" content="blog"><meta property="og:title" content="Use GAN to Generate Anime Style Pictures(to Be Continued)"><meta property="og:url" content="http://example.com/2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/"><meta property="og:site_name" content="Yuzi Liang | University of Science and Technology of China"><meta property="og:description" content="March.14.2020-   1.Web Crawler for Pixiv findPID.py findFollow.py main.py   2.Web Crawler for Konachan 3.Anime Face Recognition and Capture 4.Train   1.Web Crawler for Pixiv https:&amp;#x2F;&amp;#x2F;www.pixiv.net is a"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/images/pixiv.png"><meta property="og:image" content="http://example.com/images/pb.png"><meta property="article:published_time" content="2021-03-24T04:09:13.000Z"><meta property="article:modified_time" content="2023-09-25T21:34:42.127Z"><meta property="article:author" content="Yuzi Liang"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="Web Crawler"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/pixiv.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/"},"headline":"Yuzi Liang | University of Science and Technology of China","image":["http://example.com/images/pixiv.png","http://example.com/images/pb.png"],"datePublished":"2021-03-24T04:09:13.000Z","dateModified":"2023-09-25T21:34:42.127Z","author":{"@type":"Person","name":"Yuzi Liang"},"description":"March.14.2020-   1.Web Crawler for Pixiv findPID.py findFollow.py main.py   2.Web Crawler for Konachan 3.Anime Face Recognition and Capture 4.Train   1.Web Crawler for Pixiv https:&#x2F;&#x2F;www.pixiv.net is a"}</script><link rel="canonical" href="http://example.com/2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/"><link rel="icon" href="/img/favicon2.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/ustc_logo.jpg" alt="Yuzi Liang | University of Science and Technology of China" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-03-24T04:09:13.000Z" title="3/23/2021, 9:09:13 PM">2021-03-23</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-09-25T21:34:42.127Z" title="9/25/2023, 2:34:42 PM">2023-09-25</time></span><span class="level-item"><a class="link-muted" href="/categories/Project-Summary/">Project Summary</a></span><span class="level-item">8 minutes read (About 1216 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Use GAN to Generate Anime Style Pictures(to Be Continued)</h1><div class="content"><p><span style="color:Gray">March.14.2020-</span></p>
<!-- toc -->
<ul>
<li><a href="#1web-crawler-for-pixiv">1.Web Crawler for Pixiv</a><ul>
<li><a href="#findpidpy">findPID.py</a></li>
<li><a href="#findfollowpy">findFollow.py</a></li>
<li><a href="#mainpy">main.py</a></li>
</ul>
</li>
<li><a href="#2web-crawler-for-konachan">2.Web Crawler for Konachan</a></li>
<li><a href="#3anime-face-recognition-and-capture">3.Anime Face Recognition and Capture</a></li>
<li><a href="#4train">4.Train</a></li>
</ul>
<!-- tocstop -->
<h1><span id="1web-crawler-for-pixiv">1.Web Crawler for Pixiv</span></h1><p> <a target="_blank" rel="noopener" href="https://www.pixiv.net">https://www.pixiv.net</a> is a Japanese online community for artists. As of September 2016, the site consists of over 20 million members, over 43 million submissions, and receives over 3.7 billion page views monthly, Which means it is a great database for our project. But as we can see,  the quality of these pictures is uneven.</p>
<center class="full">
<img src="/images/pixiv.png" width="40%">
</center>

<p>To filter out the poor quality Illustrations, we have several alternatives to solve that. We chose the easiest way: By only crawling the illustrators I followed.</p>
<center class="full">
<img src="/images/pb.png" width="40%">
</center>

<p>I chose to use python to make a web crawler. My web crawler project has three programs, main.py, findPID.py, findFollow.py. We will discuss these programs in a bit more detail.</p>
<h2><span id="findpidpy">findPID.py</span></h2><p>It includes serval ways to find an illustration’s ID (each illustration has a unique ID, we need it to download the picture file).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib.request,urllib.error,urllib.parse</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"></span><br><span class="line">findID = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&quot;(\d+?)&quot;:null&#x27;</span>)</span><br><span class="line">findDailyID = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;a href=&quot;/artworks/(\d+?)&quot;class=&quot;t&#x27;</span>)</span><br><span class="line">findTagID = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&quot;id&quot;:&quot;(\d+?)&quot;,&quot;title&quot;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Author</span>(<span class="params">pid</span>):</span></span><br><span class="line">    baseurls = <span class="string">&quot;https://www.pixiv.net/ajax/user/&quot;</span></span><br><span class="line">    baseurle = <span class="string">&quot;/profile/all?lang=zh&quot;</span></span><br><span class="line">    PIDs = []</span><br><span class="line">    url = baseurls + <span class="built_in">str</span>(pid) + baseurle</span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line">    <span class="comment"># print(res)</span></span><br><span class="line">    <span class="comment"># soup = BeautifulSoup(html, &#x27;html.parser&#x27;)</span></span><br><span class="line">    <span class="comment"># html = str(html)</span></span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line"></span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    <span class="comment"># print(re.findall(findID,ret))</span></span><br><span class="line"></span><br><span class="line">    PIDs = re.findall(findID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Daily</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Daily_R18</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=daily_r18&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Weekly</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=weekly&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Weekly_R18</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=weekly_r18&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Male</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=male&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Male_R18</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=male_r18&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Female</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=female&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Female_R18</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=female_r18&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Monthly</span>():</span></span><br><span class="line">    url = <span class="string">&#x27;https://www.pixiv.net/ranking.php?mode=monthly&#x27;</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findDailyID,ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Tag</span>():</span></span><br><span class="line">    tagn = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Please enter number of tag:&#x27;</span>))</span><br><span class="line">    mode = <span class="built_in">input</span>(<span class="string">&#x27;Please enter search method:\n1.in strict accordance with tag\n2.Keywords can longer than tag\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        urle = <span class="string">&#x27;&amp;s_mode=s_tag_full&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        urle = <span class="string">&#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid input, default method 2&#x27;</span>)</span><br><span class="line">        urle = <span class="string">&#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    sumtag1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    sumtag2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    sumtag3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># urle = &#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,tagn):</span><br><span class="line">        tag = <span class="built_in">input</span>(<span class="string">&#x27;Please enter tag:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> tag.find(<span class="string">&#x27;(&#x27;</span>) &lt; <span class="number">0</span>:</span><br><span class="line">            urltag = urllib.parse.quote(tag)</span><br><span class="line">            <span class="comment"># urle = &#x27;&amp;s_mode=s_tag_full&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> count &gt; <span class="number">0</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                sumtag1 = sumtag1 + <span class="string">r&#x27;%20&#x27;</span> + urltag</span><br><span class="line">                sumtag2 = sumtag1</span><br><span class="line">                sumtag3 = sumtag3 + <span class="string">&#x27;_&#x27;</span> + tag</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                sumtag1 = urltag</span><br><span class="line">                sumtag2 = sumtag1</span><br><span class="line">                sumtag3 = tag</span><br><span class="line">        <span class="keyword">else</span>:    <span class="comment">#如果是带括号的tag</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Tag with brackets&#x27;</span>)</span><br><span class="line">            <span class="comment"># urle = &#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">            tag1 = re.split(<span class="string">&#x27;\(&#x27;</span> ,tag)</span><br><span class="line">            tag1[<span class="number">0</span>] = urllib.parse.quote(tag1[<span class="number">0</span>])</span><br><span class="line">            tag2 = re.split(<span class="string">&#x27;\)&#x27;</span> ,tag1[<span class="number">1</span>])</span><br><span class="line">            tag2[<span class="number">0</span>] = urllib.parse.quote(tag2[<span class="number">0</span>])</span><br><span class="line">            tag2[<span class="number">1</span>] = urllib.parse.quote(tag2[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> count &gt; <span class="number">0</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                sumtag2 = sumtag2 + <span class="string">r&#x27;%20&#x27;</span> + urllib.parse.quote(tag)</span><br><span class="line">                sumtag1 = sumtag1 + <span class="string">r&#x27;%20&#x27;</span> + tag1[<span class="number">0</span>] + <span class="string">&#x27;(&#x27;</span> + tag2[<span class="number">0</span>] + <span class="string">&#x27;)&#x27;</span> + tag2[<span class="number">1</span>]</span><br><span class="line">                sumtag3 = sumtag3 + <span class="string">&#x27;_&#x27;</span> + tag</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                <span class="comment"># print(urllib.parse.quote(tag))</span></span><br><span class="line">                <span class="comment"># print(tag)</span></span><br><span class="line">                sumtag2 = urllib.parse.quote(tag)</span><br><span class="line">                sumtag1 = tag1[<span class="number">0</span>] + <span class="string">&#x27;(&#x27;</span> + tag2[<span class="number">0</span>] + <span class="string">&#x27;)&#x27;</span> + tag2[<span class="number">1</span>]</span><br><span class="line">                sumtag3 = tag</span><br><span class="line">                <span class="comment"># print(sumtag2)</span></span><br><span class="line">                <span class="comment"># print(sumtag1)</span></span><br><span class="line">    sumtag3 = sumtag3 + <span class="string">&#x27;_mode&#x27;</span> + mode</span><br><span class="line">    urls = <span class="string">&#x27;https://www.pixiv.net/ajax/search/artworks/&#x27;</span></span><br><span class="line">    urlm1 = <span class="string">&#x27;?word=&#x27;</span></span><br><span class="line">    urlm2 = <span class="string">&#x27;&amp;order=date_d&amp;mode=all&amp;p=&#x27;</span></span><br><span class="line">    <span class="comment"># urle = &#x27;&amp;s_mode=s_tag_full&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    <span class="comment"># tag = input(&#x27;请输入要查找的tag:&#x27;)</span></span><br><span class="line"></span><br><span class="line">    p = <span class="built_in">input</span>(<span class="string">&#x27;Please enter the page you need to download:&#x27;</span>)</span><br><span class="line">    url = urls + sumtag1 + urlm1 + sumtag2 + urlm2 + p +urle</span><br><span class="line">    <span class="comment"># print(sumtag2)</span></span><br><span class="line">    <span class="comment"># print(url)</span></span><br><span class="line">    res = askUrl(url)</span><br><span class="line">    html = res.read()</span><br><span class="line">    ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    PIDs = re.findall(findTagID, ret)</span><br><span class="line">    <span class="built_in">print</span>(PIDs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(PIDs))</span><br><span class="line">    PIDs.append(sumtag3)</span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPIDs_by_Tag_sort</span>():</span></span><br><span class="line">    tagn = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Please enter number of tag:&#x27;</span>))</span><br><span class="line">    mode = <span class="built_in">input</span>(<span class="string">&#x27;Please enter search method:\n1.in strict accordance with tag\n2.Keywords can longer than tag\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        urle = <span class="string">&#x27;&amp;s_mode=s_tag_full&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        urle = <span class="string">&#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid input, default method 2&#x27;</span>)</span><br><span class="line">        urle = <span class="string">&#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    sumtag1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    sumtag2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    sumtag3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># urle = &#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,tagn):</span><br><span class="line">        tag = <span class="built_in">input</span>(<span class="string">&#x27;Please enter tag:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> tag.find(<span class="string">&#x27;(&#x27;</span>) &lt; <span class="number">0</span>:</span><br><span class="line">            urltag = urllib.parse.quote(tag)</span><br><span class="line">            <span class="comment"># urle = &#x27;&amp;s_mode=s_tag_full&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> count &gt; <span class="number">0</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                sumtag1 = sumtag1 + <span class="string">r&#x27;%20&#x27;</span> + urltag</span><br><span class="line">                sumtag2 = sumtag1</span><br><span class="line">                sumtag3 = sumtag3 + <span class="string">&#x27;_&#x27;</span> + tag</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                sumtag1 = urltag</span><br><span class="line">                sumtag2 = sumtag1</span><br><span class="line">                sumtag3 = tag</span><br><span class="line">        <span class="keyword">else</span>:    <span class="comment">#如果是带括号的tag</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Tag with brackets&#x27;</span>)</span><br><span class="line">            <span class="comment"># urle = &#x27;&amp;s_mode=s_tag&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">            tag1 = re.split(<span class="string">&#x27;\(&#x27;</span> ,tag)</span><br><span class="line">            tag1[<span class="number">0</span>] = urllib.parse.quote(tag1[<span class="number">0</span>])</span><br><span class="line">            tag2 = re.split(<span class="string">&#x27;\)&#x27;</span> ,tag1[<span class="number">1</span>])</span><br><span class="line">            tag2[<span class="number">0</span>] = urllib.parse.quote(tag2[<span class="number">0</span>])</span><br><span class="line">            tag2[<span class="number">1</span>] = urllib.parse.quote(tag2[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> count &gt; <span class="number">0</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                sumtag2 = sumtag2 + <span class="string">r&#x27;%20&#x27;</span> + urllib.parse.quote(tag)</span><br><span class="line">                sumtag1 = sumtag1 + <span class="string">r&#x27;%20&#x27;</span> + tag1[<span class="number">0</span>] + <span class="string">&#x27;(&#x27;</span> + tag2[<span class="number">0</span>] + <span class="string">&#x27;)&#x27;</span> + tag2[<span class="number">1</span>]</span><br><span class="line">                sumtag3 = sumtag3 + <span class="string">&#x27;_&#x27;</span> + tag</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                <span class="comment"># print(urllib.parse.quote(tag))</span></span><br><span class="line">                <span class="comment"># print(tag)</span></span><br><span class="line">                sumtag2 = urllib.parse.quote(tag)</span><br><span class="line">                sumtag1 = tag1[<span class="number">0</span>] + <span class="string">&#x27;(&#x27;</span> + tag2[<span class="number">0</span>] + <span class="string">&#x27;)&#x27;</span> + tag2[<span class="number">1</span>]</span><br><span class="line">                sumtag3 = tag</span><br><span class="line">                <span class="comment"># print(sumtag2)</span></span><br><span class="line">                <span class="comment"># print(sumtag1)</span></span><br><span class="line">    sumtag3 = sumtag3 + <span class="string">&#x27;_mode&#x27;</span> + mode</span><br><span class="line">    urls = <span class="string">&#x27;https://www.pixiv.net/ajax/search/artworks/&#x27;</span></span><br><span class="line">    urlm1 = <span class="string">&#x27;?word=&#x27;</span></span><br><span class="line">    urlm2 = <span class="string">&#x27;&amp;order=date_d&amp;mode=all&amp;p=&#x27;</span></span><br><span class="line">    <span class="comment"># urle = &#x27;&amp;s_mode=s_tag_full&amp;type=all&amp;lang=zh&#x27;</span></span><br><span class="line">    <span class="comment"># tag = input(&#x27;请输入要查找的tag:&#x27;)</span></span><br><span class="line">    p = <span class="number">1</span></span><br><span class="line">    PIDs = []</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;page = %d&#x27;</span> %p)</span><br><span class="line">        url = urls + sumtag1 + urlm1 + sumtag2 + urlm2 + <span class="built_in">str</span>(p) + urle</span><br><span class="line">        res = askUrl(url)</span><br><span class="line">        html = res.read()</span><br><span class="line">        ret = gzip.decompress(html).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        AddPIDs = re.findall(findTagID, ret)</span><br><span class="line"></span><br><span class="line">        PIDs = PIDs + AddPIDs</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(AddPIDs) &lt; <span class="number">60</span> <span class="keyword">or</span> p &gt; <span class="number">999</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        p = p + <span class="number">1</span></span><br><span class="line">    PIDs.append(sumtag3)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># p = input(&#x27;Please enter the page you need to download:&#x27;)</span></span><br><span class="line">    <span class="comment"># url = urls + sumtag1 + urlm1 + sumtag2 + urlm2 + p +urle</span></span><br><span class="line">    <span class="comment"># # print(sumtag2)</span></span><br><span class="line">    <span class="comment"># # print(url)</span></span><br><span class="line">    <span class="comment"># res = askUrl(url)</span></span><br><span class="line">    <span class="comment"># html = res.read()</span></span><br><span class="line">    <span class="comment"># ret = gzip.decompress(html).decode(&quot;utf-8&quot;)</span></span><br><span class="line">    <span class="comment"># # print(ret)</span></span><br><span class="line">    <span class="comment"># PIDs = re.findall(findTagID, ret)</span></span><br><span class="line">    <span class="comment"># print(PIDs)</span></span><br><span class="line">    <span class="comment"># print(len(PIDs))</span></span><br><span class="line">    <span class="comment"># PIDs.append(sumtag3)</span></span><br><span class="line">    <span class="keyword">return</span> PIDs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">askUrl</span>(<span class="params">url</span>):</span></span><br><span class="line">    head = &#123;</span><br><span class="line">        <span class="comment">#for security I delete my header</span></span><br><span class="line">    &#125;</span><br><span class="line">    request = urllib.request.Request(url, headers=head)</span><br><span class="line">    html = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = urllib.request.urlopen(request)</span><br><span class="line">        <span class="comment"># html = response.read()</span></span><br><span class="line">        <span class="comment"># print(response)</span></span><br><span class="line">        <span class="comment"># print(html)</span></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> urllib.error.URLError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(e, <span class="string">&quot;code&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(e.code)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(e, <span class="string">&quot;reason&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(e.reason)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># findPIDs_by_Author(4338012)</span></span><br><span class="line"><span class="comment"># findPIDs_by_Daily()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Daily_R18()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Weekly()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Weekly_R18()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Male()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Male_R18()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Female()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Female_R18()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Monthly()</span></span><br><span class="line"><span class="comment"># findPIDs_by_Tag()</span></span><br></pre></td></tr></table></figure>
<h2><span id="findfollowpy">findFollow.py</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request,urllib.error</span><br><span class="line"><span class="keyword">import</span> getInfo</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">findUID = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\&#123;&quot;userId&quot;:&quot;(\d+?)&quot;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findFollow</span>(<span class="params">mode</span>):</span></span><br><span class="line">    urls = <span class="string">&#x27;https://www.pixiv.net/ajax/user/14937409/following?offset=&#x27;</span></span><br><span class="line">    urlm1 = <span class="string">&#x27;&amp;limit=100&#x27;</span></span><br><span class="line">    urlm2 = <span class="string">&#x27;&amp;rest=&#x27;</span></span><br><span class="line">    urle = <span class="string">&#x27;&amp;tag=&amp;lang=zh&#x27;</span></span><br><span class="line">    follows = []</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="number">1</span>:</span><br><span class="line">        smode = <span class="string">&#x27;hide&#x27;</span></span><br><span class="line">        follow = getInfo.getHideFollow()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        smode = <span class="string">&#x27;show&#x27;</span></span><br><span class="line">        follow = getInfo.getShowFollow()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,math.ceil(follow/<span class="number">100</span>)):</span><br><span class="line">        num = i*<span class="number">100</span></span><br><span class="line">        url = urls + <span class="built_in">str</span>(num) + urlm1 + urlm2 + smode + urle</span><br><span class="line">        res = askUrl(url)</span><br><span class="line">        html = <span class="built_in">str</span>(res.read())</span><br><span class="line">        <span class="comment"># print(res.read())</span></span><br><span class="line">        <span class="comment"># print(html)</span></span><br><span class="line">        fos = re.findall(findUID,html)</span><br><span class="line">        <span class="comment"># print(fos)</span></span><br><span class="line">        <span class="comment"># print(len(fos))</span></span><br><span class="line">        follows.extend(fos)</span><br><span class="line">        <span class="comment"># print(follows)</span></span><br><span class="line">        <span class="comment"># print(len(follows))</span></span><br><span class="line">    <span class="keyword">return</span> follows</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">askUrl</span>(<span class="params">url</span>):</span></span><br><span class="line">    head = &#123;</span><br><span class="line">        <span class="comment">#for security I delete my header</span></span><br><span class="line">    &#125;</span><br><span class="line">    request = urllib.request.Request(url, headers=head)</span><br><span class="line">    html = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = urllib.request.urlopen(request)</span><br><span class="line">        <span class="comment"># html = response.read()</span></span><br><span class="line">        <span class="comment"># print(response)</span></span><br><span class="line">        <span class="comment"># print(html)</span></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> urllib.error.URLError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(e, <span class="string">&quot;code&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(e.code)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(e, <span class="string">&quot;reason&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(e.reason)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># findFollow(2)</span></span><br></pre></td></tr></table></figure>
<h2><span id="mainpy">main.py</span></h2><h1><span id="2web-crawler-for-konachan">2.Web Crawler for Konachan</span></h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#from bs4 import BeautifulSoup</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">basePath = <span class="string">r&#x27;/usr/share/nginx/od/ML/&#x27;</span></span><br><span class="line">findImg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&quot;directlink largeimg&quot; href=&quot;(.+?)&quot;&#x27;</span>)</span><br><span class="line">findID = re.<span class="built_in">compile</span>(<span class="string">r&#x27;Post.register\(&#123;&quot;id&quot;:(.+?),&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">url, filename</span>):</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filename):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;file exists!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, stream=<span class="literal">True</span>, timeout=<span class="number">600</span>)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=<span class="number">1024</span>):</span><br><span class="line">                <span class="keyword">if</span> chunk:  <span class="comment"># filter out keep-alive new chunks</span></span><br><span class="line">                    f.write(chunk)</span><br><span class="line">                    f.flush()</span><br><span class="line">        <span class="keyword">return</span> filename</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(filename):</span><br><span class="line">            os.remove(filename)</span><br><span class="line">        <span class="keyword">raise</span> KeyboardInterrupt</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        traceback.print_exc()</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(filename):</span><br><span class="line">            os.remove(filename)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">os.chdir(basePath)</span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;Konachan&#x27;</span>) <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">    os.makedirs(<span class="string">&#x27;Konachan&#x27;</span>)</span><br><span class="line"></span><br><span class="line">path = basePath + <span class="string">&#x27;Konachan/&#x27;</span></span><br><span class="line">os.chdir(path)</span><br><span class="line"></span><br><span class="line">start = <span class="number">1</span></span><br><span class="line">end = <span class="number">20</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, end + <span class="number">1</span>):</span><br><span class="line">    url = <span class="string">&#x27;http://konachan.net/post?page=%d&amp;tags=&#x27;</span> % i</span><br><span class="line">    html = requests.get(url).text</span><br><span class="line">    <span class="comment"># soup = BeautifulSoup(html, &#x27;html.parser&#x27;)</span></span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line">    imgs = re.findall(findImg,html)</span><br><span class="line">    ids = re.findall(findID,html)</span><br><span class="line">    <span class="comment"># print(imgs)</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> imgs:</span><br><span class="line">        <span class="comment"># target_url = &#x27;http:&#x27; + img[&#x27;src&#x27;]</span></span><br><span class="line">        target_url = img</span><br><span class="line">        <span class="comment"># print(target_url)</span></span><br><span class="line">        <span class="built_in">id</span> = ids[count]</span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line">        <span class="comment"># filename = os.path.join(&#x27;Konachan&#x27;, target_url.split(&#x27;/&#x27;)[-1])</span></span><br><span class="line">        filename = <span class="built_in">id</span> + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">        download(target_url, filename)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%d / %d&#x27;</span> % (i, end))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1><span id="3anime-face-recognition-and-capture">3.Anime Face Recognition and Capture</span></h1><p>Based on a project on github: <a target="_blank" rel="noopener" href="https://github.com/nagadomi/lbpcascade_animeface">https://github.com/nagadomi/lbpcascade_animeface</a></p>
<h1><span id="4train">4.Train</span></h1></div><div class="article-licensing box"><div class="licensing-title"><p>Use GAN to Generate Anime Style Pictures(to Be Continued)</p><p><a href="http://example.com/2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/">http://example.com/2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Yuzi Liang</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-03-23</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-09-25</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Machine-Learning/">Machine Learning</a><a class="link-muted mr-2" rel="tag" href="/tags/Web-Crawler/">Web Crawler</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/03/23/Application-of-Selenium-Auto-Daily-Health-Report/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Application of Selenium: Auto Daily Health Report</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/03/23/stock-price-forecast-based-on-Monte-Carlo-method-and-machine-learning/"><span class="level-item">Stock Price Forecast Based on Monte Carlo Method and Machine Learning</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://example.com/2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/';
            this.page.identifier = '2021/03/23/Use-GAN-to-Generate-Anime-Style-Pictures-to-Be-Continued/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'lyz' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-09-28T00:13:37.000Z">2023-09-27</time></p><p class="title"><a href="/2023/09/27/Image-Generator-Application-and-Implementation-of-StyleGAN-1/">Image Generator: Application and Implementation of StyleGAN</a></p><p class="categories"><a href="/categories/Project-Summary/">Project Summary</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-11T22:35:16.000Z">2023-04-11</time></p><p class="title"><a href="/2023/04/11/CNN-with-Pytorch/">CNN with Pytorch</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-04T04:22:22.000Z">2023-04-03</time></p><p class="title"><a href="/2023/04/03/Diffusion-model/">Diffusion model</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-08T02:10:30.000Z">2022-11-07</time></p><p class="title"><a href="/2022/11/07/TensorFlow-Tutorial/">TensorFlow Tutorial</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-28T22:58:52.000Z">2022-05-28</time></p><p class="title"><a href="/2022/05/28/Lattice-Boltzmann-Method/">Lattice Boltzmann Method</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Demo/"><span class="level-start"><span class="level-item">Demo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Learning-Notes/"><span class="level-start"><span class="level-item">Learning Notes</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Project-Summary/"><span class="level-start"><span class="level-item">Project Summary</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Magnetics/"><span class="tag">Magnetics</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Monte-Carlo-Method/"><span class="tag">Monte Carlo Method</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PyTorch/"><span class="tag">PyTorch</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Selenium/"><span class="tag">Selenium</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TensorFlow/"><span class="tag">TensorFlow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Thermoelectricity/"><span class="tag">Thermoelectricity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web-Crawler/"><span class="tag">Web Crawler</span><span class="tag">3</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/ustc_logo.jpg" alt="Yuzi Liang | University of Science and Technology of China" height="28"></a><p class="is-size-7"><span>&copy; 2023 Yuzi Liang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>