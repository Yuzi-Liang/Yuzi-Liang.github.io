<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>TensorFlow Tutorial - Yuzi Liang | University of Science and Technology of China</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Yuzi Liang | University of Science and Technology of China"><meta name="msapplication-TileImage" content="/img/favicon2.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Yuzi Liang | University of Science and Technology of China"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="TensorFlow 2.x Tutorial Pandas Load data into pandas Reading data in Pandas Sorting&amp;#x2F;Describing Data Making changes to the data Saving Data (Exporting into Desired Format) Filtering Data Conditional"><meta property="og:type" content="blog"><meta property="og:title" content="TensorFlow Tutorial"><meta property="og:url" content="http://example.com/2022/11/07/TensorFlow-Tutorial/"><meta property="og:site_name" content="Yuzi Liang | University of Science and Technology of China"><meta property="og:description" content="TensorFlow 2.x Tutorial Pandas Load data into pandas Reading data in Pandas Sorting&amp;#x2F;Describing Data Making changes to the data Saving Data (Exporting into Desired Format) Filtering Data Conditional"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/.com//nns.png"><meta property="article:published_time" content="2022-11-08T02:10:30.000Z"><meta property="article:modified_time" content="2023-01-01T10:36:12.113Z"><meta property="article:author" content="Yuzi Liang"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="TensorFlow"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/.com//nns.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2022/11/07/TensorFlow-Tutorial/"},"headline":"Yuzi Liang | University of Science and Technology of China","image":["http://example.com/.com//nns.png"],"datePublished":"2022-11-08T02:10:30.000Z","dateModified":"2023-01-01T10:36:12.113Z","author":{"@type":"Person","name":"Yuzi Liang"},"description":"TensorFlow 2.x Tutorial Pandas Load data into pandas Reading data in Pandas Sorting&#x2F;Describing Data Making changes to the data Saving Data (Exporting into Desired Format) Filtering Data Conditional"}</script><link rel="canonical" href="http://example.com/2022/11/07/TensorFlow-Tutorial/"><link rel="icon" href="/img/favicon2.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/ustc_logo.jpg" alt="Yuzi Liang | University of Science and Technology of China" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-11-08T02:10:30.000Z" title="11/7/2022, 6:10:30 PM">2022-11-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-01-01T10:36:12.113Z" title="1/1/2023, 2:36:12 AM">2023-01-01</time></span><span class="level-item"><a class="link-muted" href="/categories/Learning-Notes/">Learning Notes</a></span><span class="level-item">9 minutes read (About 1380 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">TensorFlow Tutorial</h1><div class="content"><!-- toc -->
<ul>
<li><a href="#tensorflow-2x-tutorial">TensorFlow 2.x Tutorial</a><ul>
<li><a href="#pandas">Pandas</a><ul>
<li><a href="#load-data-into-pandas">Load data into pandas</a></li>
<li><a href="#reading-data-in-pandas">Reading data in Pandas</a></li>
<li><a href="#sortingdescribing-data">Sorting/Describing Data</a></li>
<li><a href="#making-changes-to-the-data">Making changes to the data</a></li>
<li><a href="#saving-data-exporting-into-desired-format">Saving Data (Exporting into Desired Format)</a></li>
<li><a href="#filtering-data">Filtering Data</a></li>
<li><a href="#conditional-changes">Conditional Changes</a></li>
<li><a href="#aggregate-statistics-groupby">Aggregate Statistics (Groupby)</a></li>
<li><a href="#working-with-large-amounts-of-data">Working with large amounts of data</a></li>
</ul>
</li>
<li><a href="#numpy">Numpy</a><ul>
<li><a href="#load-in-numpy">Load in numPy</a></li>
<li><a href="#the-basic">The basic</a></li>
<li><a href="#get-dimension">Get dimension</a></li>
<li><a href="#get-shape">Get shape</a></li>
<li><a href="#get-type">Get type</a></li>
<li><a href="#get-size">Get size</a></li>
<li><a href="#get-total-size">Get total size</a></li>
<li><a href="#get-a-specific-element-row-column">Get a specific element [row, column]</a></li>
<li><a href="#get-a-specific-row">Get a specific row</a></li>
<li><a href="#get-a-specific-column">Get a specific column</a></li>
<li><a href="#start_indexend_indexstepsize">[start_index:end_index:stepsize]</a></li>
<li><a href="#change-value">Change value</a></li>
<li><a href="#3-d-example">3-d example</a></li>
<li><a href="#initializing-different-types-of-arrays">Initializing different types of arrays</a></li>
<li><a href="#operation">Operation</a></li>
</ul>
</li>
<li><a href="#program-element-in-tensorflow">Program Element in TensorFlow</a><ul>
<li><a href="#constant">Constant</a></li>
<li><a href="#variable">Variable</a><ul>
<li><a href="#cast">Cast</a></li>
<li><a href="#elementwise">Elementwise</a></li>
<li><a href="#slicing-indexing">Slicing, indexing</a></li>
<li><a href="#reshaping">Reshaping</a></li>
<li><a href="#numpy">numpy</a></li>
<li><a href="#differences-between-variable-and-constant">Differences between variable and constant</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#keras">Keras</a><ul>
<li><a href="#load-data">Load data</a></li>
<li><a href="#model">Model</a></li>
<li><a href="#loss-and-optimizer">Loss and optimizer</a></li>
<li><a href="#training">Training</a></li>
<li><a href="#evaluate">Evaluate</a></li>
<li><a href="#predictions">Predictions</a></li>
<li><a href="#another-way-to-do-predictions-model-softmax">Another way to do predictions: model + softmax</a></li>
<li><a href="#slicing">Slicing</a></li>
</ul>
</li>
<li><a href="#linear-regression">Linear Regression</a><ul>
<li><a href="#load-data-1">Load data</a></li>
<li><a href="#clean-data">Clean data</a></li>
<li><a href="#convert-categorical-origin-data-into-one-hot-data">Convert categorical ‘Origin’ data into one-hot data</a></li>
<li><a href="#split-the-data-into-train-and-test">Split the data into train and test</a></li>
<li><a href="#split-features-from-labels">Split features from labels</a></li>
<li><a href="#plot">Plot</a></li>
<li><a href="#normalize">Normalize</a></li>
<li><a href="#regression">Regression</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1><span id="tensorflow-2x-tutorial">TensorFlow 2.x Tutorial</span></h1><h2><span id="pandas">Pandas</span></h2><h3><span id="load-data-into-pandas">Load data into pandas</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;pokemon_data.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># print(df.head(5))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># df_xlsx = pd.read_excel(&#x27;pokemon_data.xlsx&#x27;)</span></span><br><span class="line"><span class="comment"># print(df_xlsx.head(3))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># df = pd.read_csv(&#x27;pokemon_data.txt&#x27;, sep=&#x27;\t&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(df.head(5))</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;HP&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h3><span id="reading-data-in-pandas">Reading data in Pandas</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### Read Headers</span></span><br><span class="line">df.columns</span><br><span class="line"></span><br><span class="line"><span class="comment">## Read each Column</span></span><br><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Type 1&#x27;</span>, <span class="string">&#x27;HP&#x27;</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment">## Read Each Row</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">	<span class="built_in">print</span>(index, row[<span class="string">&#x27;Name&#x27;</span>])</span><br><span class="line">df.loc[df[<span class="string">&#x27;Type 1&#x27;</span>] == <span class="string">&quot;Grass&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">## Read a specific location (R,C)</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">2</span>,<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<h3><span id="sortingdescribing-data">Sorting/Describing Data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br><span class="line"></span><br><span class="line">df.sort_values([<span class="string">&#x27;Type 1&#x27;</span>, <span class="string">&#x27;HP&#x27;</span>], ascending=[<span class="number">1</span>,<span class="number">0</span>])  <span class="comment"># 1 is for ascending, 0 is for descending, or just use True or False</span></span><br></pre></td></tr></table></figure>
<h3><span id="making-changes-to-the-data">Making changes to the data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># df[&#x27;Total&#x27;] = df[&#x27;HP&#x27;] + df[&#x27;Attack&#x27;] + df[&#x27;Defense&#x27;] + df[&#x27;Sp. Atk&#x27;] + df[&#x27;Sp. Def&#x27;] + df[&#x27;Speed&#x27;]</span></span><br><span class="line"><span class="comment"># df = df.drop(columns=[&#x27;Total&#x27;])</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;Total&#x27;</span>] = df.iloc[:, <span class="number">4</span>:<span class="number">10</span>].<span class="built_in">sum</span>(axis=<span class="number">1</span>)  <span class="comment">#do the same thing as the first row</span></span><br><span class="line"></span><br><span class="line">cols = <span class="built_in">list</span>(df.columns)</span><br><span class="line">df = df[cols[<span class="number">0</span>:<span class="number">4</span>] + [cols[-<span class="number">1</span>]] + cols[<span class="number">4</span>:<span class="number">12</span>]]</span><br><span class="line"></span><br><span class="line">df.head(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="saving-data-exporting-into-desired-format">Saving Data (Exporting into Desired Format)</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># df.to_csv(&#x27;modified.csv&#x27;, index=False)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># df.to_excel(&#x27;modified.xlsx&#x27;, index=False)</span></span><br><span class="line"></span><br><span class="line">df.to_csv(<span class="string">&#x27;modified.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27;\t&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="filtering-data">Filtering Data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">new_df = df.loc[(df[<span class="string">&#x27;Type 1&#x27;</span>] == <span class="string">&#x27;Grass&#x27;</span>) &amp; (df[<span class="string">&#x27;Type 2&#x27;</span>] == <span class="string">&#x27;Poison&#x27;</span>) &amp; (df[<span class="string">&#x27;HP&#x27;</span>] &gt; <span class="number">70</span>)]</span><br><span class="line"></span><br><span class="line">new_df = new_df.loc[~df[<span class="string">&#x27;Name&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;Mega&#x27;</span>)]  <span class="comment"># delete all the pokemons that have &#x27;Mega&#x27; in their names</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># df.loc[df[&#x27;Type 1&#x27;].str.contains(&#x27;Fire|Grass&#x27;, regex=True)]</span></span><br><span class="line"><span class="comment"># df.loc[df[&#x27;Type 1&#x27;].str.contains(&#x27;^pi[a-z]*&#x27;, flags=re.I, regex=True)]</span></span><br><span class="line"></span><br><span class="line">new_df.reset_index(drop=<span class="literal">True</span>, inplace=<span class="literal">True</span>) <span class="comment"># drop is to drop the previous index, inplace is to change the value of  itself</span></span><br><span class="line"></span><br><span class="line">new_df.to_csv(<span class="string">&#x27;filtered.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="conditional-changes">Conditional Changes</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.loc[df[<span class="string">&#x27;Type 1&#x27;</span>] == <span class="string">&#x27;Fire&#x27;</span>, <span class="string">&#x27;Type 1&#x27;</span>] = <span class="string">&#x27;Flamer&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># df.loc[df[&#x27;Total&#x27;] &gt; 500, [&#x27;Generation&#x27;,&#x27;Legendary&#x27;]] = [&#x27;Test 1&#x27;, &#x27;Test 2&#x27;]</span></span><br></pre></td></tr></table></figure>
<h3><span id="aggregate-statistics-groupby">Aggregate Statistics (Groupby)</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;modified.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">df.groupby([<span class="string">&#x27;Type 1&#x27;</span>]).mean()</span><br><span class="line">df.groupby([<span class="string">&#x27;Type 1&#x27;</span>]).mean().sort_values(<span class="string">&#x27;Defense&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">df.groupby([<span class="string">&#x27;Type 1&#x27;</span>]).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># df.groupby([&#x27;Type 1&#x27;]).count()</span></span><br><span class="line">df[<span class="string">&#x27;count&#x27;</span>] = <span class="number">1</span></span><br><span class="line">df.groupby([<span class="string">&#x27;Type 1&#x27;</span>, <span class="string">&#x27;Type 2&#x27;</span>]).count()[<span class="string">&#x27;count&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h3><span id="working-with-large-amounts-of-data">Working with large amounts of data</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for df in pd.read_csv(&#39;modified.csv&#39;, chunksize&#x3D;5):</span><br><span class="line">    results &#x3D; df.groupby([&#39;Type 1&#39;]).count()    </span><br><span class="line">    new_df &#x3D; pd.concat([new_df, results])</span><br></pre></td></tr></table></figure>
<h2><span id="numpy">Numpy</span></h2><h3><span id="load-in-numpy">Load in numPy</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<h3><span id="the-basic">The basic</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], dtype=<span class="string">&#x27;int32&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<h3><span id="get-dimension">Get dimension</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.ndim</span><br><span class="line"><span class="comment"># 1</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-shape">Get shape</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.shape</span><br><span class="line"><span class="comment"># (3,)</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-type">Get type</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.dtype</span><br><span class="line"><span class="comment"># dtype(&#x27;int32&#x27;)</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-size">Get size</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.itemsize</span><br><span class="line"><span class="comment"># 4</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-total-size">Get total size</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a.size * a.itemsize</span><br><span class="line"><span class="comment"># 12</span></span><br><span class="line">a.nbytes</span><br><span class="line"><span class="comment"># 12</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-a-specific-element-row-column">Get a specific element [row, column]</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>],[<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>]])</span><br><span class="line">a[<span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"><span class="comment"># 13</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-a-specific-row">Get a specific row</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>, :]</span><br><span class="line"><span class="comment"># array([1, 2, 3, 4, 5, 6, 7])</span></span><br></pre></td></tr></table></figure>
<h3><span id="get-a-specific-column">Get a specific column</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[:, <span class="number">2</span>]</span><br><span class="line"><span class="comment"># array([ 3, 10])</span></span><br></pre></td></tr></table></figure>
<h3><span id="start_indexend_indexstepsize">[start_index:end_index:stepsize]</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>, <span class="number">1</span>:<span class="number">6</span>:<span class="number">2</span>]</span><br><span class="line"><span class="comment"># array([2, 4, 6])</span></span><br></pre></td></tr></table></figure>
<h3><span id="change-value">Change value</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">1</span>, <span class="number">5</span>] = <span class="number">20</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[[ 1  2  3  4  5  6  7]</span></span><br><span class="line"><span class="string"> [ 8  9 10 11 12 20 14]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">a[:, <span class="number">2</span>] = <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[[ 1  2  5  4  5  6  7]</span></span><br><span class="line"><span class="string"> [ 8  9  5 11 12 20 14]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">a[:, <span class="number">2</span>] = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[[ 1  2  1  4  5  6  7]</span></span><br><span class="line"><span class="string"> [ 8  9  2 11 12 20 14]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3><span id="3-d-example">3-d example</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">b = np.array([[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]],[[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>]]])</span><br><span class="line">b[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 4</span></span><br><span class="line">b[:,<span class="number">1</span>,:]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[3, 4],</span></span><br><span class="line"><span class="string">       [7, 8]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># replace</span></span><br><span class="line">b[:,<span class="number">1</span>,:] = [[<span class="number">8</span>,<span class="number">8</span>],[<span class="number">9</span>,<span class="number">9</span>]]</span><br><span class="line">b</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[[1, 2],</span></span><br><span class="line"><span class="string">        [8, 8]],</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       [[5, 6],</span></span><br><span class="line"><span class="string">        [9, 9]]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3><span id="initializing-different-types-of-arrays">Initializing different types of arrays</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># All 0s matrix</span></span><br><span class="line">np.zeros((<span class="number">3</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">np.zeros([<span class="number">3</span>,<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># All 1s matrix</span></span><br><span class="line">np.ones((<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Any other number</span></span><br><span class="line">np.full((<span class="number">2</span>,<span class="number">2</span>), <span class="number">99</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Any other number (full_like)</span></span><br><span class="line">np.full_like(a, <span class="number">4</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[4, 4, 4, 4, 4, 4, 4],</span></span><br><span class="line"><span class="string">       [4, 4, 4, 4, 4, 4, 4]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Random decimal numbers</span></span><br><span class="line">np.random.rand(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[[[0.74976159, 0.24543374, 0.67686477, 0.73581296],</span></span><br><span class="line"><span class="string">         [0.493751  , 0.80378955, 0.89915921, 0.73957771],</span></span><br><span class="line"><span class="string">         [0.28789667, 0.01167291, 0.24646214, 0.24632085]],</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        [[0.51345246, 0.71863008, 0.21579854, 0.74275805],</span></span><br><span class="line"><span class="string">         [0.86887821, 0.75579047, 0.8425766 , 0.79416401],</span></span><br><span class="line"><span class="string">         [0.2859915 , 0.28921223, 0.91217814, 0.871138  ]]],</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       [[[0.34372382, 0.58492713, 0.66887337, 0.23508036],</span></span><br><span class="line"><span class="string">         [0.35333139, 0.47615369, 0.54830846, 0.85649478],</span></span><br><span class="line"><span class="string">         [0.53456592, 0.89527531, 0.62903241, 0.96490809]],</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        [[0.05080588, 0.67885852, 0.43191936, 0.86446833],</span></span><br><span class="line"><span class="string">         [0.78385384, 0.08768826, 0.00214857, 0.88836965],</span></span><br><span class="line"><span class="string">         [0.70274751, 0.308583  , 0.53971867, 0.74181569]]]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Random int numbers</span></span><br><span class="line">np.random.randint(-<span class="number">4</span>,<span class="number">8</span>,size=(<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[ 5, -1,  3],</span></span><br><span class="line"><span class="string">       [-1,  3,  4],</span></span><br><span class="line"><span class="string">       [-4,  7,  3]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Identity matrix</span></span><br><span class="line">np.identity(<span class="number">5</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[1., 0., 0., 0., 0.],</span></span><br><span class="line"><span class="string">       [0., 1., 0., 0., 0.],</span></span><br><span class="line"><span class="string">       [0., 0., 1., 0., 0.],</span></span><br><span class="line"><span class="string">       [0., 0., 0., 1., 0.],</span></span><br><span class="line"><span class="string">       [0., 0., 0., 0., 1.]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Repeat an array</span></span><br><span class="line">arr = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">r1 = np.repeat(arr,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(r1)</span><br><span class="line"><span class="comment"># [1 1 1 2 2 2 3 3 3]</span></span><br><span class="line">arr = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">r1 = np.repeat(arr,<span class="number">3</span>,axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(r1)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[[1 2 3]</span></span><br><span class="line"><span class="string"> [1 2 3]</span></span><br><span class="line"><span class="string"> [1 2 3]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">np.random.random_sample(a.shape)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[0.92590309, 0.69170996, 0.86595192, 0.32043676, 0.78114367,</span></span><br><span class="line"><span class="string">        0.73246055, 0.13357556],</span></span><br><span class="line"><span class="string">       [0.9876799 , 0.17386839, 0.34905811, 0.58150665, 0.74796994,</span></span><br><span class="line"><span class="string">        0.62469343, 0.10405232]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3><span id="operation">Operation</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>])</span><br><span class="line">b = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">a * b</span><br><span class="line"><span class="comment"># np.array([1, 6, 15])</span></span><br></pre></td></tr></table></figure>
<h2><span id="program-element-in-tensorflow">Program Element in TensorFlow</span></h2><h3><span id="constant">Constant</span></h3><p>Example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = tf.constant(<span class="number">2.0</span>, tf.float32)</span><br><span class="line">b = tf.constant(<span class="number">3.0</span>)</span><br><span class="line">c = tf.constant([<span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">2</span>], shape=(<span class="number">2</span>,<span class="number">2</span>), dtype=tf.float32)</span><br></pre></td></tr></table></figure>
<h3><span id="variable">Variable</span></h3><p>Example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">W = tf.Variable([<span class="number">.3</span>], dtype=tf.float32)</span><br><span class="line">b = tf.Variable([-<span class="number">.3</span>], dtype=tf.float32)</span><br><span class="line">x = tf.ones((<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line">y = tf.eye(<span class="number">3</span>)</span><br><span class="line">z = tf.random.normal((<span class="number">2</span>, <span class="number">3</span>), mean=<span class="number">0</span>, stddev=<span class="number">1</span>)</span><br><span class="line">z = tf.random.uniform((<span class="number">3</span>, <span class="number">3</span>), minval=<span class="number">0</span>, maxval=<span class="number">1</span>)</span><br><span class="line">z = tf.<span class="built_in">range</span>(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p>Down below are some operations you can do to variables</p>
<h4><span id="cast">Cast</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = tf.cast(x, dtype=tf.float32)</span><br></pre></td></tr></table></figure>
<h4><span id="elementwise">Elementwise</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">x = tf.constant([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">y = tf.constant([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line">z = x + y</span><br><span class="line">z = x - y</span><br><span class="line">z = x / y</span><br><span class="line">z = x * y</span><br><span class="line">z = x ** <span class="number">3</span></span><br><span class="line">z = tf.tensordot(x, y, axes=<span class="number">1</span>)  <span class="comment"># 点乘</span></span><br><span class="line"></span><br><span class="line">x = tf.random.normal((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">y = tf.random.normal((<span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line">z = tf.matmul(x, y)  <span class="comment"># 矩阵相乘</span></span><br><span class="line">z = x @ y  <span class="comment"># it is the same thing as above</span></span><br></pre></td></tr></table></figure>
<h4><span id="slicing-indexing">Slicing, indexing</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = tf.constant([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># tf.Tensor([1 2 3 4], shape=(4,), dtype=int32)</span></span><br><span class="line"><span class="built_in">print</span>(x[:, <span class="number">0</span>])</span><br><span class="line"><span class="comment"># tf.Tensor([1 5], shape=(2,), dtype=int32)</span></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>, :])</span><br><span class="line"><span class="comment"># tf.Tensor([1 2 3 4], shape=(4,), dtype=int32)</span></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>, <span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"><span class="comment"># tf.Tensor([2 3], shape=(2,), dtype=int32)</span></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<h4><span id="reshaping">Reshaping</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">x = tf.random.normal((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">tf.Tensor(</span></span><br><span class="line"><span class="string">[[ 0.15445794 -0.9360153   1.8880193 ]</span></span><br><span class="line"><span class="string"> [ 1.705707    0.6765113  -0.5381024 ]], shape=(2, 3), dtype=float32)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = tf.reshape(x, (<span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">tf.Tensor(</span></span><br><span class="line"><span class="string">[[ 0.15445794 -0.9360153 ]</span></span><br><span class="line"><span class="string"> [ 1.8880193   1.705707  ]</span></span><br><span class="line"><span class="string"> [ 0.6765113  -0.5381024 ]], shape=(3, 2), dtype=float32)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = tf.reshape(x, (-<span class="number">1</span>, <span class="number">2</span>))  <span class="comment"># it is the same thing as above</span></span><br></pre></td></tr></table></figure>
<h4><span id="numpy">numpy</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = tf.random.normal((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(x))</span><br><span class="line"><span class="comment"># &lt;class &#x27;tensorflow.python.framework.ops.EagerTensor&#x27;&gt;</span></span><br><span class="line">x = x.numpy()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(x))</span><br><span class="line"><span class="comment"># &lt;class &#x27;numpy.ndarray&#x27;&gt;</span></span><br><span class="line">x = tf.convert_to_tensor(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(x))</span><br><span class="line"><span class="comment"># &lt;class &#x27;tensorflow.python.framework.ops.EagerTensor&#x27;&gt;</span></span><br><span class="line">x = tf.constant([<span class="string">&quot;Patrick&quot;</span>, <span class="string">&quot;Max&quot;</span>, <span class="string">&quot;Mary&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(x))</span><br><span class="line"><span class="comment"># &lt;class &#x27;tensorflow.python.framework.ops.EagerTensor&#x27;&gt;</span></span><br></pre></td></tr></table></figure>
<h4><span id="differences-between-variable-and-constant">Differences between variable and constant</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = tf.constant([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># tf.Tensor([1 2 3], shape=(3,), dtype=int32)</span></span><br><span class="line"></span><br><span class="line">x = tf.Variable([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># &lt;tf.Variable &#x27;Variable:0&#x27; shape=(3,) dtype=int32, numpy=array([1, 2, 3], dtype=int32)&gt;</span></span><br></pre></td></tr></table></figure>
<h2><span id="keras">Keras</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<h3><span id="load-data">Load data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mnist = keras.datasets.mnist</span><br><span class="line">(x_train, y_train), (x_test, y_test) = mnist.load_data()</span><br><span class="line"><span class="built_in">print</span>(x_train.shape, y_train.shape)</span><br><span class="line">x_train, x_test = x_train / <span class="number">255.0</span>, x_test / <span class="number">255.0</span></span><br></pre></td></tr></table></figure>
<h3><span id="model">Model</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model = keras.models.Sequential([</span><br><span class="line">    keras.layers.Flatten(input_shape=(<span class="number">28</span>, <span class="number">28</span>)),</span><br><span class="line">    keras.layers.Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">10</span>),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(model.summary())</span><br></pre></td></tr></table></figure>
<h3><span id="loss-and-optimizer">Loss and optimizer</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loss = keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="literal">True</span>)</span><br><span class="line">optim = keras.optimizers.Adam(lr=<span class="number">0.001</span>)</span><br><span class="line">metrics = [<span class="string">&#x27;accuracy&#x27;</span>]</span><br><span class="line">model.<span class="built_in">compile</span>(loss=loss, optimizer=optim, metrics=metrics)</span><br></pre></td></tr></table></figure>
<h3><span id="training">Training</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">64</span></span><br><span class="line">epochs = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs, shuffle=<span class="literal">True</span>, verbose=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="evaluate">Evaluate</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.evaluate(x_test, y_test, batch_size=batch_size, verbose=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="predictions">Predictions</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">probability_model = keras.models.Sequential([</span><br><span class="line">    model,</span><br><span class="line">    keras.layers.Softmax()</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">predictions = probability_model(x_test)</span><br><span class="line">pred0 = predictions[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(pred0)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tf.Tensor(</span></span><br><span class="line"><span class="string">[8.67747713e-06 1.34659444e-07 6.02381151e-05 2.22242298e-03</span></span><br><span class="line"><span class="string"> 1.12110685e-08 6.37097673e-06 6.45393591e-12 9.97610807e-01</span></span><br><span class="line"><span class="string"> 1.71113388e-05 7.42296543e-05], shape=(10,), dtype=float32)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">label0 = np.argmax(pred0)</span><br><span class="line"><span class="built_in">print</span>(label0)</span><br><span class="line"><span class="comment"># 7</span></span><br></pre></td></tr></table></figure>
<h3><span id="another-way-to-do-predictions-model-softmax">Another way to do predictions: model + softmax</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">predictions = model(x_test)</span><br><span class="line"><span class="comment"># predictions = model.predict(x_test, batch_size = batch_size)</span></span><br><span class="line">predictions = tf.nn.softmax(predictions)</span><br><span class="line">pred0 = predictions[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(pred0)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tf.Tensor(</span></span><br><span class="line"><span class="string">[8.67747713e-06 1.34659444e-07 6.02381151e-05 2.22242298e-03</span></span><br><span class="line"><span class="string"> 1.12110685e-08 6.37097673e-06 6.45393591e-12 9.97610807e-01</span></span><br><span class="line"><span class="string"> 1.71113388e-05 7.42296543e-05], shape=(10,), dtype=float32)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">label0 = np.argmax(pred0)</span><br><span class="line"><span class="built_in">print</span>(label0)</span><br><span class="line"><span class="comment"># 7</span></span><br></pre></td></tr></table></figure>
<h3><span id="slicing">Slicing</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pred05s = predictions[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line"><span class="built_in">print</span>(pred05s.shape)</span><br><span class="line"><span class="comment"># (5, 10)</span></span><br><span class="line">label05s = np.argmax(pred05s, axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(label05s)</span><br><span class="line"><span class="comment"># [7 2 1 0 4]</span></span><br></pre></td></tr></table></figure>
<center class="pic1">
<img src="/.com//nns.png" width="80%">
</center>

<h2><span id="linear-regression">Linear Regression</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&#x27;TF_CPP_MIN_LOG_LEVEL&#x27;</span>] = <span class="string">&#x27;2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">np.set_printoptions(precision=<span class="number">3</span>, suppress=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers.experimental <span class="keyword">import</span> preprocessing</span><br></pre></td></tr></table></figure>
<h3><span id="load-data">Load data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&#x27;http://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/auto-mpg.data&#x27;</span></span><br><span class="line">column_names = [<span class="string">&#x27;MPG&#x27;</span>, <span class="string">&#x27;Cylinders&#x27;</span>, <span class="string">&#x27;Displacement&#x27;</span>, <span class="string">&#x27;Horsepower&#x27;</span>, <span class="string">&#x27;Weight&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Acceleration&#x27;</span>, <span class="string">&#x27;Model Year&#x27;</span>, <span class="string">&#x27;Origin&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dataset = pd.read_csv(url, names=column_names, na_values=<span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">                      comment=<span class="string">&#x27;\t&#x27;</span>, sep=<span class="string">&#x27; &#x27;</span>, skipinitialspace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="clean-data">Clean data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataset = dataset.dropna()</span><br></pre></td></tr></table></figure>
<h3><span id="convert-categorical-origin-data-into-one-hot-data">Convert categorical ‘Origin’ data into one-hot data</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">origin = dataset.pop(<span class="string">&#x27;Origin&#x27;</span>)</span><br><span class="line">dataset[<span class="string">&#x27;USA&#x27;</span>] = (origin == <span class="number">1</span>)*<span class="number">1</span></span><br><span class="line">dataset[<span class="string">&#x27;Europe&#x27;</span>] = (origin == <span class="number">2</span>)*<span class="number">1</span></span><br><span class="line">dataset[<span class="string">&#x27;Japan&#x27;</span>] = (origin == <span class="number">3</span>)*<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3><span id="split-the-data-into-train-and-test">Split the data into train and test</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">train_dataset = dataset.sample(frac=<span class="number">0.8</span>, random_state=<span class="number">0</span>)</span><br><span class="line">test_dataset = dataset.drop(train_dataset.index)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dataset.shape, train_dataset.shape, test_dataset.shape)</span><br><span class="line">train_dataset.describe()</span><br></pre></td></tr></table></figure>
<h3><span id="split-features-from-labels">Split features from labels</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">train_features = train_dataset.copy()</span><br><span class="line">test_features = test_dataset.copy()</span><br><span class="line"></span><br><span class="line">train_labels = train_features.pop(<span class="string">&#x27;MPG&#x27;</span>)</span><br><span class="line">test_labels = test_features.pop(<span class="string">&#x27;MPG&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="plot">Plot</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot</span>(<span class="params">feature, x=<span class="literal">None</span>, y=<span class="literal">None</span></span>):</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">    plt.scatter(train_features[feature], train_labels, label=<span class="string">&#x27;Data&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> y <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        plt.plot(x, y, color=<span class="string">&#x27;k&#x27;</span>, label=<span class="string">&#x27;Predictions&#x27;</span>)</span><br><span class="line">    plt.xlabel(feature)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;MPG&#x27;</span>)</span><br><span class="line">    plt.legend()</span><br></pre></td></tr></table></figure>
<h3><span id="normalize">Normalize</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train_dataset.describe().transpose()[[<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;std&#x27;</span>]])</span><br><span class="line"></span><br><span class="line">normalizer = preprocessing.Normalization()</span><br><span class="line">normalizer.adapt(np.array(train_features))</span><br><span class="line"><span class="built_in">print</span>(normalizer.mean.numpy())</span><br><span class="line"></span><br><span class="line">first = np.array(train_features[:<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;First example:&#x27;</span>, first)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Normalized&#x27;</span>, normalizer(first).numpy())</span><br></pre></td></tr></table></figure>
<h3><span id="regression">Regression</span></h3><ol>
<li>Normalize the input horsepower</li>
<li>Apply a linear transformation (y = m*x + b) to produce 1 output using layer.Dense</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">feature = <span class="string">&#x27;Horsepower&#x27;</span></span><br><span class="line">single_feature </span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>TensorFlow Tutorial</p><p><a href="http://example.com/2022/11/07/TensorFlow-Tutorial/">http://example.com/2022/11/07/TensorFlow-Tutorial/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Yuzi Liang</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-11-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-01-01</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Machine-Learning/">Machine Learning</a><a class="link-muted mr-2" rel="tag" href="/tags/TensorFlow/">TensorFlow</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/04/03/Diffusion-model/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Diffusion model</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/05/28/Lattice-Boltzmann-Method/"><span class="level-item">Lattice Boltzmann Method</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://example.com/2022/11/07/TensorFlow-Tutorial/';
            this.page.identifier = '2022/11/07/TensorFlow-Tutorial/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'lyz' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-11T22:35:16.000Z">2023-04-11</time></p><p class="title"><a href="/2023/04/11/CNN-with-Pytorch/">CNN with Pytorch</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-04T04:22:22.000Z">2023-04-03</time></p><p class="title"><a href="/2023/04/03/Diffusion-model/">Diffusion model</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-08T02:10:30.000Z">2022-11-07</time></p><p class="title"><a href="/2022/11/07/TensorFlow-Tutorial/">TensorFlow Tutorial</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-28T22:58:52.000Z">2022-05-28</time></p><p class="title"><a href="/2022/05/28/Lattice-Boltzmann-Method/">Lattice Boltzmann Method</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-18T01:47:06.000Z">2021-09-17</time></p><p class="title"><a href="/2021/09/17/Totorial-of-Google-Colab-and-Pytorch/">Tutorial of Google Colab and PyTorch</a></p><p class="categories"><a href="/categories/Learning-Notes/">Learning Notes</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Demo/"><span class="level-start"><span class="level-item">Demo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Learning-Notes/"><span class="level-start"><span class="level-item">Learning Notes</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Project-Summary/"><span class="level-start"><span class="level-item">Project Summary</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Magnetics/"><span class="tag">Magnetics</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Monte-Carlo-Method/"><span class="tag">Monte Carlo Method</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PyTorch/"><span class="tag">PyTorch</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Selenium/"><span class="tag">Selenium</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TensorFlow/"><span class="tag">TensorFlow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Thermoelectricity/"><span class="tag">Thermoelectricity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web-Crawler/"><span class="tag">Web Crawler</span><span class="tag">2</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/ustc_logo.jpg" alt="Yuzi Liang | University of Science and Technology of China" height="28"></a><p class="is-size-7"><span>&copy; 2023 Yuzi Liang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>